<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>CRAZE ADMIN</title>
  
  <!-- 字体 -->
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;500;700&display=swap" rel="stylesheet">
  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Netlify Identity -->
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>

  <style>
    /* ==========================================================================
       1. 全局样式重置 (Global Reset) - 确立赛博朋克基调
       ========================================================================== */
    :root {
      --neon-blue: #00f3ff;
      --neon-red: #ff0055;
      --bg-dark: #000000;
      --bg-panel: #0d0d0d;
      --border: #333;
    }

    body, html {
      background-color: var(--bg-dark) !important;
      font-family: 'Rajdhani', sans-serif !important;
      overflow: hidden; /* 防止整个页面滚动，让内部滚动 */
    }

    /* 滚动条美化 */
    ::-webkit-scrollbar { width: 4px; height: 4px; }
    ::-webkit-scrollbar-track { background: #000; }
    ::-webkit-scrollbar-thumb { background: #333; border-radius: 2px; }
    ::-webkit-scrollbar-thumb:hover { background: var(--neon-blue); }

    /* ==========================================================================
       2. 桌面端样式 (Desktop Styles)
       ========================================================================== */
    /* 顶部导航 */
    [class*="AppHeader-header"] {
      background-color: rgba(0,0,0,0.95) !important;
      border-bottom: 1px solid #222 !important;
      height: 60px !important;
    }

    /* 侧边栏 */
    [class*="SidebarContainer"] {
      background-color: var(--bg-panel) !important;
      border-right: 1px solid var(--border) !important;
    }
    [class*="SidebarNavLink"] {
      color: #666 !important;
      font-family: 'Orbitron', sans-serif !important;
      letter-spacing: 1px;
    }
    [class*="SidebarNavLink"].sidebar-active {
      color: var(--neon-blue) !important;
      background: linear-gradient(90deg, rgba(0,243,255,0.1), transparent) !important;
      border-left: 3px solid var(--neon-blue) !important;
    }

    /* 编辑器区域 */
    [class*="EditorContainer"] { background-color: var(--bg-dark) !important; }
    [class*="EditorToolbar"] { background-color: #000 !important; border-bottom: 1px solid #333 !important; }
    
    /* 输入框 */
    input, textarea, [class*="Select-control"] {
      background-color: #111 !important;
      border: 1px solid #333 !important;
      color: #eee !important;
      font-size: 16px !important;
      border-radius: 0 !important;
      padding: 12px !important;
    }
    input:focus, textarea:focus {
      border-color: var(--neon-blue) !important;
      box-shadow: 0 0 8px rgba(0, 243, 255, 0.3) !important;
    }
    label {
      color: var(--neon-blue) !important;
      font-family: 'Orbitron', sans-serif !important;
      font-size: 11px !important;
      margin-bottom: 5px !important;
      margin-top: 15px !important;
      display: block !important;
    }

    /* 按钮 */
    button[class*="Button"] {
      font-family: 'Orbitron', sans-serif !important;
      text-transform: uppercase;
      font-weight: bold;
      border-radius: 0 !important;
    }
    button[class*="Button-success"] {
      background-color: var(--neon-red) !important;
      color: white !important;
      box-shadow: 0 0 10px rgba(255,0,85,0.4);
    }

    /* ==========================================================================
       3. 移动端核心修复 (MOBILE OVERRIDES) - Max-width 800px
       ========================================================================== */
    @media (max-width: 800px) {
      
      /* A. 修复布局挤压：强制重置 Flex 结构 */
      /* 找到 React 生成的分屏容器，强制改为垂直排列 */
      div[style*="display: flex"][style*="height: 100%"] {
        flex-direction: column !important;
      }
      
      /* B. 隐藏侧边栏（默认占据屏幕太多） */
      [class*="SidebarContainer"] {
        display: none !important; /* 只有点击汉堡菜单时才通过 JS 显示，或者直接隐藏 */
      }
      
      /* C. 列表视图 (Collection) 修复 */
      /* 强制单列 */
      [class*="CollectionContainer"] main {
        padding: 10px !important;
      }
      [class*="Card"] {
        width: 100% !important;
        margin-bottom: 15px !important;
        background: #0a0a0a !important;
        border: 1px solid #333 !important;
      }
      /* 隐藏列表页多余的视图切换按钮 */
      [class*="CollectionTop-viewControls"] { display: none !important; }

      /* D. 编辑器 (Editor) 深度修复 */
      /* 1. 顶部发布栏优化 */
      [class*="EditorToolbar"] {
        position: sticky !important;
        top: 0;
        z-index: 50;
        padding: 8px !important;
        justify-content: space-between !important;
      }
      [class*="EditorToolbar-metadata"] { display: none !important; } /* 隐藏状态文字 */
      
      /* 2. 核心：拆分编辑器和预览 */
      /* 强制编辑器面板宽度 100%，取消左右分屏逻辑 */
      [class*="SplitPane"] {
        display: block !important; /* 禁用 Flex */
        overflow-y: auto !important;
        height: auto !important;
      }
      
      [class*="EditorPanel"] {
        width: 100% !important;
        border-right: none !important;
        padding-bottom: 50px !important;
      }
      
      /* 3. 预览面板在移动端 */
      [class*="PreviewPaneContainer"] {
        width: 100% !important;
        height: 500px !important; /* 给预览一个固定高度 */
        border-top: 2px solid var(--neon-blue) !important;
        display: block !important;
        background: #000 !important;
      }

      /* E. 控件优化 */
      /* 图片上传框太大，缩小 padding */
      [class*="FileWidgetButton"] {
        padding: 15px !important;
        font-size: 12px !important;
      }
      
      /* 增大输入框文字防止看不清 */
      input, textarea {
        font-size: 16px !important;
        background: #0d0d0d !important;
      }

      /* F. 弹窗修复 */
      /* 如下拉菜单被键盘顶上去的问题 */
      [class*="Dropdown-content"] {
        position: fixed !important;
        top: 20% !important;
        left: 5% !important;
        width: 90% !important;
        max-height: 60vh !important;
        overflow-y: auto !important;
      }
    }
  </style>
</head>
<body>
  <!-- Decap CMS -->
  <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script>
  
  <script>
    // --- 移动端优化版预览组件 ---
    var MobilePromptsPreview = createClass({
      render: function() {
        var entry = this.props.entry;
        var image = entry.getIn(['data', 'image']);
        var title = entry.getIn(['data', 'title']) || 'Untitled';
        var tool = entry.getIn(['data', 'tool']) || 'AI Tool';
        
        // 使用 h 函数构建 DOM
        return h('div', {className: 'bg-black text-white p-4 w-full'},
          h('div', {className: 'text-xs text-gray-500 mb-2 uppercase font-mono'}, '/// PREVIEW'),
          
          // 模拟卡片
          h('div', {className: 'border border-gray-800 bg-gray-900 w-full relative aspect-[3/4] mb-4'},
            image 
              ? h('img', {src: image, className: 'w-full h-full object-cover'}) 
              : h('div', {className: 'flex items-center justify-center h-full text-gray-700 text-xs'}, 'NO IMAGE'),
            
            h('div', {className: 'absolute bottom-0 left-0 w-full p-3 bg-gradient-to-t from-black to-transparent'},
              h('span', {className: 'inline-block px-2 py-0.5 bg-pink-600 text-[10px] font-bold mb-1'}, tool),
              h('h3', {className: 'font-mono text-lg font-bold truncate'}, title)
            )
          ),
          
          h('div', {className: 'text-xs text-cyan-400 font-mono mt-2'}, 'Changes update automatically above.')
        );
      }
    });

    // 注册预览
    CMS.registerPreviewTemplate("prompts", MobilePromptsPreview);
    
    // 注入 Tailwind 到预览 iframe
    CMS.registerPreviewStyle("https://cdn.tailwindcss.com");
    // 注入样式修正预览 iframe 的滚动条
    CMS.registerPreviewStyle("body { background-color: #000; color: #fff; } ::-webkit-scrollbar { width: 0px; }");

    // 监听 DOM 变化，强制修复一些 JS 生成的样式问题 (高级 Hack)
    document.addEventListener("DOMContentLoaded", function() {
       // 如果需要可以在这里添加额外的 JS 逻辑
    });
  </script>
</body>
</html>


