<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Content Manager</title>
  
  <!-- å¼•å…¥ Tailwind CSS (ä»…ç”¨äºé¢„è§ˆåŒºåŸŸçš„æ ·å¼æ¸²æŸ“) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Netlify Identity -->
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>

  <style>
    /* =========================================
       1. åŸºç¡€è®¾ç½® (ç³»ç»Ÿé»˜è®¤å­—ä½“ï¼Œæ¸…çˆ½é£æ ¼)
       ========================================= */
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol" !important;
      background-color: #f4f5f7 !important; /* æµ…ç°èƒŒæ™¯ */
    }

    /* æ»šåŠ¨æ¡ä¼˜åŒ– */
    ::-webkit-scrollbar { width: 6px; height: 6px; }
    ::-webkit-scrollbar-thumb { background: #ccc; border-radius: 3px; }
    ::-webkit-scrollbar-thumb:hover { background: #999; }

    /* =========================================
       2. UI ç»„ä»¶ä¼˜åŒ– (æ¡Œé¢+ç§»åŠ¨é€šç”¨)
       ========================================= */
    
    /* é¡¶éƒ¨å¯¼èˆªæ  - çº¯ç™½å¹²å‡€ */
    [class*="AppHeader-header"] {
      background-color: #ffffff !important;
      border-bottom: 1px solid #e2e8f0 !important;
      color: #333 !important;
      box-shadow: 0 2px 4px rgba(0,0,0,0.02);
      height: 60px !important;
    }
    
    /* ä¾§è¾¹æ  - æµ…ç° */
    [class*="SidebarContainer"] {
      background-color: #ffffff !important;
      border-right: 1px solid #e2e8f0 !important;
    }
    [class*="SidebarNavLink"].sidebar-active {
      color: #2563eb !important; /* é€‰ä¸­è“è‰² */
      background-color: #eff6ff !important; /* æµ…è“èƒŒæ™¯ */
      border-left: 3px solid #2563eb !important;
    }

    /* è¾“å…¥æ¡† - å¢å¤§é—´è·ï¼Œè§†è§‰èˆ’é€‚ */
    input[type="text"], textarea, [class*="Select-control"] {
      border: 1px solid #cbd5e1 !important;
      border-radius: 6px !important;
      padding: 12px !important;
      font-size: 15px !important;
      background: #fff !important;
      color: #1e293b !important;
      box-shadow: 0 1px 2px rgba(0,0,0,0.05) !important;
    }
    input:focus, textarea:focus {
      border-color: #3b82f6 !important;
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1) !important;
      outline: none;
    }

    /* æ ‡ç­¾ Label */
    label {
      color: #64748b !important;
      font-weight: 600 !important;
      font-size: 13px !important;
      margin-bottom: 6px !important;
      margin-top: 20px !important;
    }

    /* å¡ç‰‡åˆ—è¡¨ */
    [class*="Card"] {
      background: #fff !important;
      border: 1px solid #e2e8f0 !important;
      border-radius: 8px !important;
      box-shadow: 0 1px 3px rgba(0,0,0,0.05) !important;
    }
    [class*="Card"]:hover {
      box-shadow: 0 4px 6px rgba(0,0,0,0.05) !important;
      border-color: #3b82f6 !important;
    }
    [class*="Card-cardTop"] { color: #1e293b !important; font-weight: 600; }

    /* =========================================
       3. ç§»åŠ¨ç«¯å¼ºåˆ¶é€‚é… (Max-width: 800px)
       ========================================= */
    @media (max-width: 800px) {
      
      /* A. å¸ƒå±€é‡æ„ï¼šå¼ºåˆ¶ä¸Šä¸‹å †å  */
      /* è¦†ç›– React SplitPane çš„é»˜è®¤ Flex æ ·å¼ */
      div[style*="display: flex"][style*="height: 100%"] {
        display: block !important;
        height: auto !important;
      }

      /* B. éšè—ä¾§è¾¹æ ï¼Œç»™ç¼–è¾‘å™¨è…¾ä½ç½® */
      [class*="SidebarContainer"] {
        display: none !important; 
      }

      /* C. åˆ—è¡¨é¡µè°ƒæ•´ */
      [class*="CollectionContainer"] main { padding: 10px !important; }
      [class*="Card"] {
        width: 100% !important;
        margin-bottom: 12px !important;
      }
      /* éšè—å¤šä½™æŒ‰é’® */
      [class*="CollectionTop-viewControls"] { display: none !important; }

      /* D. ç¼–è¾‘å™¨åŒºåŸŸä¼˜åŒ– */
      /* 1. é¡¶éƒ¨å‘å¸ƒæ å›ºå®š */
      [class*="EditorToolbar"] {
        position: sticky !important;
        top: 0;
        z-index: 100;
        background: #fff !important;
        border-bottom: 1px solid #e2e8f0 !important;
        padding: 10px !important;
      }
      /* éšè—å‘å¸ƒçŠ¶æ€æ–‡å­—ï¼ŒèŠ‚çœç©ºé—´ */
      [class*="EditorToolbar-metadata"] { display: none !important; }

      /* 2. ç¼–è¾‘å™¨é¢æ¿ (ä¸ŠåŠéƒ¨åˆ†) */
      [class*="EditorPanel"] {
        width: 100% !important;
        height: auto !important;
        overflow: visible !important;
        padding-bottom: 20px !important;
        border-right: none !important;
      }

      /* 3. é¢„è§ˆé¢æ¿ (ä¸‹åŠéƒ¨åˆ†) */
      [class*="PreviewPaneContainer"] {
        width: 100% !important;
        height: auto !important;
        min-height: 400px; /* ä¿è¯æœ‰è¶³å¤Ÿé«˜åº¦æ˜¾ç¤ºé¢„è§ˆ */
        border-top: 4px solid #e2e8f0 !important; /* åˆ†å‰²çº¿ */
        background: #f8fafc !important;
        display: block !important;
        padding-bottom: 50px !important;
      }

      /* E. ç»†èŠ‚ä¼˜åŒ– */
      /* iOS é˜²ç¼©æ”¾ï¼šå­—ä½“å¼ºåˆ¶ 16px */
      input, textarea { font-size: 16px !important; }
      
      /* å›¾ç‰‡ä¸Šä¼ æŒ‰é’®åŠ å¤§ */
      [class*="FileWidgetButton"] { padding: 16px !important; background: #f8fafc !important; }

      /* æ±‰å ¡èœå•é¢œè‰²ä¿®å¤ */
      button[class*="AppHeader-menuButton"] { color: #333 !important; }
    }
  </style>
</head>
<body>
  <!-- Decap CMS -->
  <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script>
  
  <script>
    // --- ç®€çº¦ç‰ˆé¢„è§ˆç»„ä»¶ ---
    // å³ä½¿åå°æ˜¯ç®€çº¦çš„ï¼Œé¢„è§ˆä¹Ÿåº”è¯¥è®©ä½ çœ‹åˆ°å†…å®¹çš„ç»“æ„
    var SimplePreview = createClass({
      render: function() {
        var entry = this.props.entry;
        var image = entry.getIn(['data', 'image']);
        var title = entry.getIn(['data', 'title']) || 'æ— æ ‡é¢˜';
        var tool = entry.getIn(['data', 'tool']) || 'AI Tool';
        var prompt = entry.getIn(['data', 'prompt']) || 'æš‚æ—  Prompt å†…å®¹...';
        
        // ä½¿ç”¨ h å‡½æ•°æ„å»º (äº®è‰²èƒŒæ™¯é¢„è§ˆ)
        return h('div', {className: 'w-full max-w-md mx-auto bg-white min-h-screen p-4 border-x border-gray-100 shadow-sm'},
          
          h('div', {className: 'text-xs text-gray-400 mb-4 font-bold tracking-wider text-center'}, 'PREVIEW é¢„è§ˆæ¨¡å¼'),

          // å›¾ç‰‡å¡ç‰‡
          h('div', {className: 'rounded-lg overflow-hidden border border-gray-200 shadow-sm mb-6 aspect-[3/4] relative bg-gray-50'},
             image 
              ? h('img', {src: image, className: 'w-full h-full object-cover'}) 
              : h('div', {className: 'flex flex-col items-center justify-center h-full text-gray-400 text-sm'}, 
                  h('span', {}, 'ğŸ–¼ï¸'),
                  h('span', {className: 'mt-2'}, 'æ­¤å¤„æ˜¾ç¤ºå›¾ç‰‡')
                ),
             
             // åº•éƒ¨ç®€å•çš„é®ç½©æ–‡å­—
             h('div', {className: 'absolute bottom-0 left-0 w-full p-3 bg-gradient-to-t from-black/60 to-transparent text-white'},
                h('div', {className: 'text-[10px] font-bold bg-blue-600 inline-block px-1.5 py-0.5 rounded mb-1'}, tool),
                h('div', {className: 'font-bold text-sm truncate'}, title)
             )
          ),

          // æ–‡å­—ä¿¡æ¯
          h('div', {className: 'bg-gray-50 p-4 rounded border border-gray-200'},
            h('h3', {className: 'text-xs font-bold text-gray-500 uppercase mb-2'}, 'Prompt å†…å®¹'),
            h('p', {className: 'text-gray-700 text-sm font-mono leading-relaxed break-all'}, prompt)
          )
        );
      }
    });

    // æ³¨å†Œåˆ° "prompts" é›†åˆ
    CMS.registerPreviewTemplate("prompts", SimplePreview);
    
    // æ³¨å…¥ Tailwind åˆ°é¢„è§ˆ iframe (æ–¹ä¾¿æ’ç‰ˆ)
    CMS.registerPreviewStyle("https://cdn.tailwindcss.com");
    // ä¿®æ­£ iframe å†…çš„æ»šåŠ¨æ¡
    CMS.registerPreviewStyle("body { background-color: #fff; } ::-webkit-scrollbar { width: 0; }");
  </script>
</body>
</html>
